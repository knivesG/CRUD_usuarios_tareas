<div class="container">
      <div class="header">
        <h2>{{ isEditMode ? 'Editar Tarea' : 'Nueva Tarea' }}</h2>
        <a routerLink="/tareas" class="btn btn-secondary">
          ← Volver
        </a>
      </div>

      <div class="card">
        <div class="card-body">
          <div *ngIf="error" class="alert alert-error">
            {{ error }}
          </div>

          <form (ngSubmit)="onSubmit()" #taskForm="ngForm">
            <div class="form-row">
              <div class="form-group">
                <label for="titulo">Título *</label>
                <input
                  type="text"
                  id="titulo"
                  name="titulo"
                  [(ngModel)]="task.titulo"
                  required
                  class="form-control"
                  placeholder="Ingrese el título de la tarea"
                  #titulo="ngModel"
                >
                <div *ngIf="titulo.invalid && (titulo.dirty || titulo.touched)" 
                     class="error-message">
                  El título es requerido
                </div>
              </div>

              <div class="form-group">
                <label for="estado">Estado *</label>
                <select
                  id="estado"
                  name="estado"
                  [(ngModel)]="task.estado"
                  required
                  class="form-control"
                  #estado="ngModel"
                >
                  <option value="">Seleccione un estado</option>
                  <option value="pendiente">Pendiente</option>
                  <option value="en_progreso">En Progreso</option>
                  <option value="completada">Completada</option>
                </select>
                <div *ngIf="estado.invalid && (estado.dirty || estado.touched)" 
                     class="error-message">
                  El estado es requerido
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="descripcion">Descripción</label>
              <textarea
                id="descripcion"
                name="descripcion"
                [(ngModel)]="task.descripcion"
                class="form-control textarea"
                rows="4"
                placeholder="Ingrese una descripción detallada de la tarea"
              ></textarea>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="entrega_fecha">Fecha de Vencimiento</label>
                <input
                  type="date"
                  id="entrega_fecha"
                  name="entrega_fecha"
                  [(ngModel)]="task.entrega_fecha"
                  class="form-control"
                >
              </div>

              <div class="form-group">
                <label for="usuario_id">Asignar a Usuario</label>
                <select
                  id="usuario_id"
                  name="usuario_id"
                  [(ngModel)]="task.usuario_id"
                  class="form-control"
                >
                  <option value="">Sin asignar</option>
                  <option *ngFor="let user of users" [value]="user.id">
                    {{ user.nombre }}
                  </option>
                </select>
              </div>
            </div>

            <div class="form-actions">
              <button
                type="submit"
                class="btn btn-primary"
                [disabled]="taskForm.invalid || loading"
              >
                <span *ngIf="loading">Guardando...</span>
                <span *ngIf="!loading">
                  {{ isEditMode ? 'Actualizar' : 'Crear' }} Tarea
                </span>
              </button>
              <a routerLink="/tareas" class="btn btn-outline">
                Cancelar
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>